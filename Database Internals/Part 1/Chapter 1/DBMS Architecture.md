*데이터베이스 관리 시스템*[^DataBase Management System] 설계를 위한 일반적인 청사진은 없습니다. 모든 데이터베이스는 조금씩 다르게 만들어졌기 때문에, 그것을 구성하고 있는 컴포넌트를 정의하기가 다소 어렵습니다. 각각의 컴포넌트에 대해 문서화가 잘 되어있다고 하더라도, 독립적으로 보이는 컴포넌트들도 작업 수행의 최적화나 특별한 경우에 대한 처리, 또는 설계적 결정 등의 이유로 독립적이지 않을 수도 있습니다.

DBMS 아키텍처는 여러 문서에서 각각 다르게 컴포넌트와 그것들 사이의 관계를 정의합니다. 아래의 그림은 공통적으로 사용되는 컴포넌트를 보여주는 아키텍처입니다.
![[스크린샷 2024-04-25 오전 5.46.10.png|center|280]]

DBMS는 *client/server* 모델을 사용합니다. 여기서 데이터베이스 시스템 인스턴스(*node*)가 *server*의 역할을 하고, 어플리케이션 인스턴스가 *client* 역할을 합니다.

*client*의 요청은 *transport 서브시스템*을 통해 전달됩니다. 요청들은 쿼리의 형태로 이루어지고, 대부분의 경우 쿼리 언어로 표현됩니다. *transport 서브시스템*은 또한 데이터베이스 클러스터에서 다른 *node*와의 커뮤니케이션을 책임집니다.

*transport 서브시스템*은 (요청으로부터 받은) 쿼리를 *query processor*로 보내서 파싱하거나, 해석하거나 유효성을 검증합니다. 접근 제어 확인은 그 이후에 수행되는데, 이것은 쿼리가 해석된 후에 완전히 수행할 수 있기 때문입니다.

파싱된 쿼리는 *query optimizer*로 보내집니다. 여기서는 쿼리에서 불필요한 부분을 먼저 제거하고, 내부 통계(인덱스 개수, 교차 정보의 근사치 등)와 데이터 배치(클러스터 내에서 어떤 노드가 데이터를 갖고 있는지 및 데이터 전송과 관련된 비용)를 기반으로 가장 효율적인 실행 방법을 찾습니다. *query optimizer*는 (의존성 트리로 표현되는) 쿼리 해결에 필요한 관계형 작업과 인덱스 순서 지정, 개수 추정 및 액세스 방법 선택과 같은 최적화 작업을 모두 처리합니다.

쿼리는 보통 *execution plan*(또는 *query plan*) 형식으로 표현됩니다.[^1] 같은 쿼리라도 다른 *execution plan*을 사용하면 효율이 달라질 수 있기 때문에, *query optimizer*는 이용가능한 가장 좋은 *execution plan*을 선택합니다.

*execution plan*은 *execution engine*이 처리하는데, 이것은 로컬 및 원격 작업 수행의 결과를 모아둡니다. *remote execution*은 클러스터의 다른 *node*에 데이터를 쓰고 읽거나, 복제하는 작업이 포함될 수 있습니다.

로컬 쿼리(*client*로부터 직접 또는 다른 *node*에서 오는)는 *storage engine*에 의해 수행됩니다. *storage engine*은 다음과 같은 구성 요소가 있습니다.
- *transaction manager* : 트랜잭션을 예약하고 트랜잭션이 논리적으로 일관되지 않은 상태로 데이터베이스를 남겨둘 수 없도록 합니다.
- *lock manager* : 트랜잭션이 실행되고 있는 데이터베이스 객체에 락을 걸어서, 동시 작어비 물리적 데이터 무결성을 위반하지 않음을 보장합니다.
- *access methods* : 디스크의 데이터를 정리하고 접근을 관리합니다. *access methods*는 힙 파일과 (*B-Tree*나 *LSM Tree* 같은) 스토리지 구조를 포함합니다.
- *buffer manager* : 메모리에 데이터 페이지를 캐싱합니다.
- *recovery manager* : 작업 로그를 관리하고 장애가 발생한 경우 시스템 상태를 복구합니다.
*transaction manager*와 *lock manager*는 동시성 제어를 담당합니다:논리적, 물리적 데이터 무결성을 보장하고, 동시 작업이 가능한 한 효율적으로 수행되도록 합니다.

#DataBase #DataBaseInternals 

[^1]: 이 형식은 결과가 완전한 것으로 간주되기 위해 수행되어야 하는 작업 시퀀스를 의미합니다.