*너비 우선 탐색*[^Breadth-first search]는 그래프를 탐색하는 간단하지만 중요한 알고리즘입니다. 최소 신장 트리를 구하는 Prim 알고리즘이나 최단 거리를 찾는 Dijkstra 알고리즘에서도 너비 우선 탐색 알고리즘의 아이디어를 사용합니다.

그래프 $G=(V, E)$와 시작 노드 $s$가 주어졌을 때, 너비 우선 탐색은 $s$에서 갈 수 있는 모든 노드를 체계적으로 탐색합니다. 이것은 $s$에서 갈 수 있는 노드까지의 거리를 계산할 수 있고, $s$를 루트 노드로 가지면서 갈 수 있는 노드들을 포함하는 '너비 우선 트리'를 구성할 수도 있습니다. 그 트리에는, $s$에서 갈 수 있는 임의의 노드 $v$에 대해, $s$에서 $v$로 가는 가장 짧은 경로가 저장됩니다. 이 알고리즘은 유향 그래프와 무향 그래프 모두에 대해 작동합니다.

이 알고리즘이 '너비 우선' 이라는 이름이 붙은 이유는 탐색된 노드와 그렇지 않은 노드의 경계를 그 경계의 너비를 확장하는 방식으로 탐색이 수행되기 때문입니다. 이것은 그래프를 탐색할 때 현재 위치한 노드와 직접 연결되어 있는 모든 노드를 먼저 탐색하는 것을 말합니다. 다시 말하면, 노드 $s$로부터 거리가 $k + 1$인 노드를 탐색하기 전에 거리가 $k$인 모든 노드를 먼저 탐색하는 방식입니다.

너비 우선 탐색의 기본적인 과정은 다음과 같이 묘사될 수 있습니다: 그래프의 모든 노드는 흰색인 상태로 탐색이 시작됩니다. 각각의 노드는 회색 또는 검정색으로 칠해질 수 있고, 탐색이 모두 끝나면 모든 노드는 검정색으로 칠해지게 됩니다. 어떤 노드 $u$가 탐색에 의해 방문되었고, $u$의 이웃 노드들이 모두 탐색되지 않았다면 $u$는 회색으로 칠해진 상태입니다. $u$의 모든 이웃 노드가 방문되었다면 $u$는 검정색으로 칠해집니다. 이 방식을 관찰해보면, 간선 $(u, v) \in E$에 대해 $u$가 검정색으로 칠해져 있다면, 노드 $v$는 반드시 회색 또는 검정색으로 칠해져 있어야 합니다. 반면, 회색으로 칠해져 있는 노드는 흰색 노드와 인접해 있을 수 있습니다. 이것으로부터, 회색 노드는 방문한 노드와 그렇지 않은 노드의 경계를 의미하는 것으로 볼 수 있습니다.

너비 우선 탐색은 *너비 우선 트리*[^breadth-first tree]를 구성합니다. 이 트리의 초기 상태는 루트 노드로 시작 노드인 $s$만 가집니다. 이미 방문한 노드 $u$의 인접 리스트를 조회하면서 흰색인 노드 $v$가 발견되면, 그 노드 $v$와 간선 $(u,v)$가 트리에 추가됩니다. 즉, 여기서 노드 $u$는 노드 $v$의 부모 노드가 됩니다. 각각의 노드는 많아야 한 번 방문되기 때문에, 각각의 노드는 많아야 하나의 부모 노드를 가집니다. 이것과 비슷하게 조상 노드 또는 자손 노드에 대한 묘사도 가능합니다.

아래의 의사 코드는 그래프 $G=(V, E)$가 인접 리스트로 주어졌을 때 너비 우선 탐색을 구현한 것입니다.

#Graph #BFS